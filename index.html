<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Class & Frequency Calculator</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #f5f7fa;
    padding: 20px;
  }
  .container {
    max-width: 600px;
    margin: auto;
    background: white;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 0 10px #ccc;
  }
  label, select, input {
    display: block;
    margin: 10px 0 6px;
    font-weight: bold;
  }
  input[type=text], select {
    padding: 8px;
    width: 100%;
    box-sizing: border-box;
  }
  .small-input {
    width: 80px;
    display: inline-block;
  }
  .inputs-row {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
    margin-bottom: 15px;
  }
  button {
    background: #007BFF;
    color: white;
    padding: 10px 15px;
    border: none;
    cursor: pointer;
    font-size: 18px;
    border-radius: 5px;
    margin-top: 10px;
  }
  button:hover {
    background: #0056b3;
  }
  #result {
    margin-top: 20px;
    font-size: 22px;
    font-weight: bold;
  }
  .hidden {
    display: none;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 10px;
  }
  th, td {
    border: 1px solid #ddd;
    text-align: center;
    padding: 6px;
  }
</style>
</head>
<body>

<div class="container">
  <h2>Mean, Median, Mode Calculator (Simple & Class Data)</h2>

  <label for="calcType">Select Calculation:</label>
  <select id="calcType" onchange="resetInputs()">
    <option value="">--Select--</option>
    <option value="mean">Mean</option>
    <option value="median">Median</option>
    <option value="mode">Mode</option>
  </select>

  <label for="dataType">Select Data Type:</label>
  <select id="dataType" onchange="resetInputs()">
    <option value="">--Select--</option>
    <option value="simple">Simple Data</option>
    <option value="classFreq">Class & Frequency Data</option>
  </select>

  <div id="medianSeriesDiv" class="hidden">
    <label for="medianSeries">For Median, select series type:</label>
    <select id="medianSeries">
      <option value="discreteOdd">Discrete Series (Odd total)</option>
      <option value="discreteEven">Discrete Series (Even total)</option>
      <option value="continuous">Continuous Series</option>
    </select>
  </div>

  <div id="simpleInputDiv" class="hidden">
    <label for="simpleData">Enter numbers (comma separated):</label>
    <input type="text" id="simpleData" placeholder="e.g. 10, 20, 20, 30" />
  </div>

  <div id="classFreqInputDiv" class="hidden">
    <label>Enter class intervals and frequencies:</label>
    <table id="classFreqTable">
      <thead>
        <tr>
          <th>Class Interval (e.g. 10-20)</th>
          <th>Frequency (f)</th>
          <th><button type="button" onclick="addClassRow()"> + </button></th>
        </tr>
      </thead>
      <tbody id="classFreqBody">
        <tr>
          <td><input type="text" class="classInterval" placeholder="e.g. 10-20" /></td>
          <td><input type="number" class="frequency" min="0" value="0" /></td>
          <td><button type="button" onclick="removeClassRow(this)"> - </button></td>
        </tr>
      </tbody>
    </table>
  </div>

  <button onclick="calculate()">Calculate</button>

  <div id="result"></div>
</div>

<script>
  const calcTypeElem = document.getElementById("calcType");
  const dataTypeElem = document.getElementById("dataType");
  const medianSeriesDiv = document.getElementById("medianSeriesDiv");
  const medianSeriesElem = document.getElementById("medianSeries");
  const simpleInputDiv = document.getElementById("simpleInputDiv");
  const classFreqInputDiv = document.getElementById("classFreqInputDiv");
  const resultDiv = document.getElementById("result");

  // Show/hide inputs based on selection
  function resetInputs() {
    resultDiv.textContent = "";
    const calcType = calcTypeElem.value;
    const dataType = dataTypeElem.value;

    medianSeriesDiv.classList.add("hidden");
    simpleInputDiv.classList.add("hidden");
    classFreqInputDiv.classList.add("hidden");

    if (!calcType || !dataType) return;

    if (calcType === "median") {
      medianSeriesDiv.classList.remove("hidden");
    }

    if (dataType === "simple") {
      simpleInputDiv.classList.remove("hidden");
    } else if (dataType === "classFreq") {
      classFreqInputDiv.classList.remove("hidden");
    }
  }

  // Add row in class freq table
  function addClassRow() {
    const tbody = document.getElementById("classFreqBody");
    const row = document.createElement("tr");
    row.innerHTML = `
      <td><input type="text" class="classInterval" placeholder="e.g. 10-20" /></td>
      <td><input type="number" class="frequency" min="0" value="0" /></td>
      <td><button type="button" onclick="removeClassRow(this)"> - </button></td>
    `;
    tbody.appendChild(row);
  }

  function removeClassRow(btn) {
    const row = btn.closest("tr");
    row.remove();
  }

  // Parse simple input string to array of numbers
  function parseSimpleData() {
    const input = document.getElementById("simpleData").value;
    if (!input.trim()) return null;
    const nums = input.split(",").map(n => parseFloat(n.trim())).filter(n => !isNaN(n));
    if (nums.length === 0) return null;
    return nums;
  }

  // Parse class intervals and frequencies
  function parseClassFreq() {
    const intervalsElems = document.querySelectorAll(".classInterval");
    const freqElems = document.querySelectorAll(".frequency");
    let classes = [];
    let frequencies = [];
    for (let i = 0; i < intervalsElems.length; i++) {
      const cls = intervalsElems[i].value.trim();
      const freq = parseFloat(freqElems[i].value);
      if (!cls || isNaN(freq) || freq < 0) {
        return null; // invalid data
      }
      frequencies.push(freq);
      // Parse class interval
      const parts = cls.split("-");
      if (parts.length !== 2) return null;
      const lower = parseFloat(parts[0].trim());
      const upper = parseFloat(parts[1].trim());
      if (isNaN(lower) || isNaN(upper) || upper <= lower) return null;
      classes.push({ lower, upper });
    }
    return { classes, frequencies };
  }

  // Calculate mean of simple data
  function meanSimple(nums) {
    const sum = nums.reduce((a,b) => a+b, 0);
    return sum / nums.length;
  }

  // Calculate median of simple data (sorted)
  function medianSimple(nums) {
    nums.sort((a,b) => a-b);
    const mid = Math.floor(nums.length/2);
    if (nums.length % 2 === 0) {
      return (nums[mid-1] + nums[mid]) / 2;
    } else {
      return nums[mid];
    }
  }

  // Calculate mode of simple data
  function modeSimple(nums) {
    const freq = {};
    nums.forEach(n => freq[n] = (freq[n] || 0) + 1);
    let maxFreq = 0;
    let modes = [];
    for (let num in freq) {
      if (freq[num] > maxFreq) {
        maxFreq = freq[num];
        modes = [Number(num)];
      } else if (freq[num] === maxFreq) {
        modes.push(Number(num));
      }
    }
    if (modes.length === Object.keys(freq).length) return "No mode";
    return modes.join(", ");
  }

  // Calculate mean for class-frequency data
  function meanClassFreq(classes, frequencies) {
    let sumFiXi = 0;
    let sumF = 0;
    for (let i=0; i<classes.length; i++) {
      const mid = (classes[i].lower + classes[i].upper) / 2;
      sumFiXi += mid * frequencies[i];
      sumF += frequencies[i];
    }
    return sumFiXi / sumF;
  }

  // Calculate median for class frequency data, discrete odd, discrete even, or continuous
  function medianClassFreq(classes, frequencies, seriesType) {
    let n = frequencies.reduce((a,b) => a + b, 0);
    let cumFreq = [];
    let sum = 0;
    for (let f of frequencies) {
      sum += f;
      cumFreq.push(sum);
    }

    if (seriesType === "discreteOdd" || seriesType === "discreteEven") {
      // Median is middle value, depending on odd or even n
      // For odd: middle is (n+1)/2
      // For even: middle is average of n/2 and n/2+1th values
      if (seriesType === "discreteOdd") {
        let medianPos = (n+1) / 2;
        for (let i=0; i<cumFreq.length; i++) {
          if (cumFreq[i] >= medianPos) {
            return (classes[i].lower + classes[i].upper) / 2;
          }
        }
      } else {
        let pos1 = n/2;
        let pos2 = pos1 + 1;
        let median1, median2;
        for (let i=0; i<cumFreq.length; i++) {
          if (!median1 && cumFreq[i] >= pos1) {
            median1 = (classes[i].lower + classes[i].upper) / 2;
          }
          if (!median2 && cumFreq[i] >= pos2) {
            median2 = (classes[i].lower + classes[i].upper) / 2;
            break;
          }
        }
        return (median1 + median2) / 2;
      }
    } else if (seriesType === "continuous") {
      // For continuous series, use formula:
      // Median = L + [(n/2 - F)/f] * h
      // L = lower boundary of median class
      // F = cumulative freq before median class
      // f = freq of median class
      // h = class width (assumed equal width for all classes)
      let halfN = n/2;
      let medianClassIndex = cumFreq.findIndex(cf => cf >= halfN);
      let L = classes[medianClassIndex].lower;
      let F = medianClassIndex === 0 ? 0 : cumFreq[medianClassIndex - 1];
      let f = frequencies[medianClassIndex];
      let h = classes[medianClassIndex].upper - classes[medianClassIndex].lower;

      let median = L + ((halfN - F) / f) * h;
      return median;
    }
    return null; // If none matched
  }

  // Calculate mode for class frequency data
  function modeClassFreq(classes, frequencies) {
    // Mode class = class with max freq 
    let maxFreq = Math.max(...frequencies);
    let modeIndices = [];
    frequencies.forEach((f,i) => { if (f === maxFreq) modeIndices.push(i); });

    if (modeIndices.length !== 1) {
      return "No unique mode";
    }

    let i = modeIndices[0];
    // For grouped data, mode = L + [(f1 - f0) / (2f1 - f0 - f2)] * h
    // where f1 = freq of modal class, f0 = freq before modal class, f2 = freq after modal class, h = class width
    let f1 = frequencies[i];
    let f0 = i === 0 ? 0 : frequencies[i-1];
    let f2 = i === frequencies.length - 1 ? 0 : frequencies[i+1];
    let L = classes[i].lower;
    let h = classes[i].upper - classes[i].lower;

    let denominator = (2*f1 - f0 - f2);
    if (denominator === 0) return "Cannot calculate mode";

    let mode = L + ((f1 - f0)/denominator) * h;
    return mode;
  }


  function calculate() {
    const calcType = calcTypeElem.value;
    const dataType = dataTypeElem.value;
    resultDiv.textContent = "";

    if (!calcType) {
      alert("Select calculation type");
      return;
    }
    if (!dataType) {
      alert("Select data type");
      return;
    }

    if (dataType === "simple") {
      let nums = parseSimpleData();
      if (!nums) {
        alert("Enter valid simple data");
        return;
      }
      if (calcType === "mean") {
        const mean = meanSimple(nums);
        resultDiv.textContent = `Mean: ${mean.toFixed(2)}`;
      } else if (calcType === "median") {
        const median = medianSimple(nums);
        resultDiv.textContent = `Median: ${median.toFixed(2)}`;
      } else if (calcType === "mode") {
        const mode = modeSimple(nums);
        resultDiv.textContent = `Mode: ${mode}`;
      }
    } else if (dataType === "classFreq") {
      let parsed = parseClassFreq();
      if (!parsed) {
        alert("Enter valid class intervals and frequencies");
        return;
      }
      let { classes, frequencies } = parsed;

      if (calcType === "mean") {
        const mean = meanClassFreq(classes, frequencies);
        resultDiv.textContent = `Mean: ${mean.toFixed(2)}`;
      } else if (calcType === "median") {
        let seriesType = medianSeriesElem.value;
        if (!seriesType) {
          alert("Select median series type");
          return;
        }
        const median = medianClassFreq(classes, frequencies, seriesType);
        if (median === null) {
          resultDiv.textContent = "Cannot calculate median for selected inputs";
        } else {
          resultDiv.textContent = `Median: ${median.toFixed(2)}`;
        }
      } else if (calcType === "mode") {
        const mode = modeClassFreq(classes, frequencies);
        resultDiv.textContent = `Mode: ${typeof mode === "string" ? mode : mode.toFixed(2)}`;
      }
    }
  }

  calcTypeElem.addEventListener("change", resetInputs);
  dataTypeElem.addEventListener("change", resetInputs);

</script>

</body>
</html>
